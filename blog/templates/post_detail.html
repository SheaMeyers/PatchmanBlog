{% extends 'base.html' %}

{% block content %}
    <div>
        <h2>{{ post.title }}</h2>
        <p>{{ post.content }}</p>
        <p>By: {{ post.author }}</p>
        <p>Created on: {{ post.created_date }}</p>
    </div>

    {% if user.is_authenticated %}
        <a href="{% url 'post_edit' pk=post.pk %}">Edit Post</a>
    {% endif %}

     <form method="POST" class="post-form">{% csrf_token %}
        {{ form.as_p }}
        <button type="submit">Save</button>
    </form>

    <h3>Replies</h3>
    {% for reply in post.replies.all %}
        {% if not reply.is_deleted %}
            {% if user.is_authenticated or reply.approved_reply %}
            <div>
                <p>{{ reply.content }}</p>
                <p>{{ reply.name }}</p>
                <div>
                    {{ reply.created_date }}
                    {% if not reply.approved_reply %}
                        <a href="{% url 'reply_remove' pk=reply.pk %}"></a>
                        <a href="{% url 'reply_approve' pk=reply.pk %}"></a>
                    {% endif %}
                </div>
            </div>
            {% else %}
                <p>No replies yet</p>
            {% endif %}
        {% else %}
            <p>No replies yet</p>
        {% endif %}
    {% empty %}
        <p>No replies yet</p>
    {% endfor %}
{% endblock %}